import socket

def scan_ports(target):
    common_ports = [21, 22, 23, 25, 80, 110, 443]
    open_ports = []

    print(f"Scanning {target} for common ports...")

    for port in common_ports:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(1)
        result = s.connect_ex((target, port))
        if result == 0:
            open_ports.append(port)
        s.close()

    return open_ports

def banner_grabbing(target, port):
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(1)
        s.connect((target, port))
        s.send(b'HEAD / HTTP/1.1\r\nHost: {}\r\n\r\n'.format(target).encode())
        banner = s.recv(1024).decode().strip()
        s.close()
        return banner
    except Exception as e:
        return str(e)

def main():
    target = input("Enter the target IP address: ")
    
    open_ports = scan_ports(target)

    if not open_ports:
        print("No common ports are open.")
        return

    print("\nOpen Ports:")
    for port in open_ports:
        print(f"Port {port}")
        banner = banner_grabbing(target, port)
        print(f"  Banner: {banner}")

if __name__ == "__main__":
    main()
